# Agent 工作规范

本文档定义了 AI Agent 在本项目中的工作规范和约定。

## 基础约定

- 使用中文回复
- 称呼用户为 Joe
- 修改文件前先展示 diff 预览
- 不确定时询问 Joe

## 代码约定

- 变量和注释使用英文
- 保持简洁，避免过度抽象
- 无需向后兼容，可自由打破旧格式

## 文档约定

- 格式：Markdown
- 路径：`docs/` 目录
- 设计文档：`docs/DESIGN.md`
- 进度文档：`docs/PROGRESS.md`

## 任务完成工作流

每次完成一个任务后，必须执行以下步骤：

### 1. 更新文档

根据任务性质，更新相关文档：
- 功能变更 → 更新 `docs/PROGRESS.md`
- 架构变更 → 更新 `docs/DESIGN.md`
- 配置变更 → 更新配置文件注释和示例

### 2. 提示 Git 提交

任务完成后，主动询问 Joe：

> 任务已完成。是否需要提交到 git？
>
> 变更摘要：
> - [列出主要变更]
>
> 建议的 commit message：
> - [提供建议的提交信息]

### 3. 等待确认

- 如果 Joe 确认提交，执行 git add 和 git commit
- 如果 Joe 拒绝或要求修改，按指示操作
- 不要自动 push，除非 Joe 明确要求

## 项目特定约定

### Rust 代码

- 使用 `thiserror` 定义错误类型
- 使用 `tracing` 进行日志记录
- 异步代码使用 `tokio` 运行时

### 测试

- 单元测试放在模块内部的 `#[cfg(test)]` 块中
- 运行 `cargo test` 验证变更不会引入回归
